<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>JSON Editor Example</title>
	<link rel='stylesheet' href="./css/main.css">
	<script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
	<!-- <script src="./polyfills/assign.js"></script> -->
	<!-- placeholders for the theme switcher -->
	<link rel='stylesheet' id='theme_stylesheet'>
	<link rel='stylesheet' id='icon_stylesheet'>

	<style>
		[class*="foundicon-"] {
			font-family: GeneralFoundicons;
			font-style: normal;
		}
	</style>
	<!-- <script src='dist/jsoneditor.js'></script> -->

	<script>
		/**
		 * LZString compression library
		 * Used to create direct links to the demo.
		 * NOT REQUIRED for JSON Editor.
		 * https://github.com/pieroxy/lz-string
		 */
		var LZString = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", _f: String.fromCharCode, compressToBase64: function (e) { if (e == null) return ""; var t = ""; var n, r, i, s, o, u, a; var f = 0; e = LZString.compress(e); while (f < e.length * 2) { if (f % 2 == 0) { n = e.charCodeAt(f / 2) >> 8; r = e.charCodeAt(f / 2) & 255; if (f / 2 + 1 < e.length) i = e.charCodeAt(f / 2 + 1) >> 8; else i = NaN } else { n = e.charCodeAt((f - 1) / 2) & 255; if ((f + 1) / 2 < e.length) { r = e.charCodeAt((f + 1) / 2) >> 8; i = e.charCodeAt((f + 1) / 2) & 255 } else r = i = NaN } f += 3; s = n >> 2; o = (n & 3) << 4 | r >> 4; u = (r & 15) << 2 | i >> 6; a = i & 63; if (isNaN(r)) { u = a = 64 } else if (isNaN(i)) { a = 64 } t = t + LZString._keyStr.charAt(s) + LZString._keyStr.charAt(o) + LZString._keyStr.charAt(u) + LZString._keyStr.charAt(a) } return t }, decompressFromBase64: function (e) { if (e == null) return ""; var t = "", n = 0, r, i, s, o, u, a, f, l, c = 0, h = LZString._f; e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); while (c < e.length) { u = LZString._keyStr.indexOf(e.charAt(c++)); a = LZString._keyStr.indexOf(e.charAt(c++)); f = LZString._keyStr.indexOf(e.charAt(c++)); l = LZString._keyStr.indexOf(e.charAt(c++)); i = u << 2 | a >> 4; s = (a & 15) << 4 | f >> 2; o = (f & 3) << 6 | l; if (n % 2 == 0) { r = i << 8; if (f != 64) { t += h(r | s) } if (l != 64) { r = o << 8 } } else { t = t + h(r | i); if (f != 64) { r = s << 8 } if (l != 64) { t += h(r | o) } } n += 3 } return LZString.decompress(t) }, compressToUTF16: function (e) { if (e == null) return ""; var t = "", n, r, i, s = 0, o = LZString._f; e = LZString.compress(e); for (n = 0; n < e.length; n++) { r = e.charCodeAt(n); switch (s++) { case 0: t += o((r >> 1) + 32); i = (r & 1) << 14; break; case 1: t += o(i + (r >> 2) + 32); i = (r & 3) << 13; break; case 2: t += o(i + (r >> 3) + 32); i = (r & 7) << 12; break; case 3: t += o(i + (r >> 4) + 32); i = (r & 15) << 11; break; case 4: t += o(i + (r >> 5) + 32); i = (r & 31) << 10; break; case 5: t += o(i + (r >> 6) + 32); i = (r & 63) << 9; break; case 6: t += o(i + (r >> 7) + 32); i = (r & 127) << 8; break; case 7: t += o(i + (r >> 8) + 32); i = (r & 255) << 7; break; case 8: t += o(i + (r >> 9) + 32); i = (r & 511) << 6; break; case 9: t += o(i + (r >> 10) + 32); i = (r & 1023) << 5; break; case 10: t += o(i + (r >> 11) + 32); i = (r & 2047) << 4; break; case 11: t += o(i + (r >> 12) + 32); i = (r & 4095) << 3; break; case 12: t += o(i + (r >> 13) + 32); i = (r & 8191) << 2; break; case 13: t += o(i + (r >> 14) + 32); i = (r & 16383) << 1; break; case 14: t += o(i + (r >> 15) + 32, (r & 32767) + 32); s = 0; break } } return t + o(i + 32) }, decompressFromUTF16: function (e) { if (e == null) return ""; var t = "", n, r, i = 0, s = 0, o = LZString._f; while (s < e.length) { r = e.charCodeAt(s) - 32; switch (i++) { case 0: n = r << 1; break; case 1: t += o(n | r >> 14); n = (r & 16383) << 2; break; case 2: t += o(n | r >> 13); n = (r & 8191) << 3; break; case 3: t += o(n | r >> 12); n = (r & 4095) << 4; break; case 4: t += o(n | r >> 11); n = (r & 2047) << 5; break; case 5: t += o(n | r >> 10); n = (r & 1023) << 6; break; case 6: t += o(n | r >> 9); n = (r & 511) << 7; break; case 7: t += o(n | r >> 8); n = (r & 255) << 8; break; case 8: t += o(n | r >> 7); n = (r & 127) << 9; break; case 9: t += o(n | r >> 6); n = (r & 63) << 10; break; case 10: t += o(n | r >> 5); n = (r & 31) << 11; break; case 11: t += o(n | r >> 4); n = (r & 15) << 12; break; case 12: t += o(n | r >> 3); n = (r & 7) << 13; break; case 13: t += o(n | r >> 2); n = (r & 3) << 14; break; case 14: t += o(n | r >> 1); n = (r & 1) << 15; break; case 15: t += o(n | r); i = 0; break }s++ } return LZString.decompress(t) }, compressToUint8Array: function (e) { var t = LZString.compress(e); var n = new Uint8Array(t.length * 2); for (var r = 0, i = t.length; r < i; r++) { var s = t.charCodeAt(r); n[r * 2] = s >>> 8; n[r * 2 + 1] = s % 256 } return n }, decompressFromUint8Array: function (e) { if (e === null || e === undefined) { return LZString.decompress(e) } else { var t = new Array(e.length / 2); for (var n = 0, r = t.length; n < r; n++) { t[n] = e[n * 2] * 256 + e[n * 2 + 1] } return LZString.decompress(String.fromCharCode.apply(null, t)) } }, compressToEncodedURIComponent: function (e) { return LZString.compressToBase64(e).replace(/=/g, "$").replace(/\//g, "-") }, decompressFromEncodedURIComponent: function (e) { if (e) e = e.replace(/$/g, "=").replace(/-/g, "/"); return LZString.decompressFromBase64(e) }, compress: function (e) { if (e == null) return ""; var t, n, r = {}, i = {}, s = "", o = "", u = "", a = 2, f = 3, l = 2, c = "", h = 0, p = 0, d, v = LZString._f; for (d = 0; d < e.length; d += 1) { s = e.charAt(d); if (!Object.prototype.hasOwnProperty.call(r, s)) { r[s] = f++; i[s] = true } o = u + s; if (Object.prototype.hasOwnProperty.call(r, o)) { u = o } else { if (Object.prototype.hasOwnProperty.call(i, u)) { if (u.charCodeAt(0) < 256) { for (t = 0; t < l; t++) { h = h << 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } } n = u.charCodeAt(0); for (t = 0; t < 8; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } else { n = 1; for (t = 0; t < l; t++) { h = h << 1 | n; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = 0 } n = u.charCodeAt(0); for (t = 0; t < 16; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } a--; if (a == 0) { a = Math.pow(2, l); l++ } delete i[u] } else { n = r[u]; for (t = 0; t < l; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } a--; if (a == 0) { a = Math.pow(2, l); l++ } r[o] = f++; u = String(s) } } if (u !== "") { if (Object.prototype.hasOwnProperty.call(i, u)) { if (u.charCodeAt(0) < 256) { for (t = 0; t < l; t++) { h = h << 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } } n = u.charCodeAt(0); for (t = 0; t < 8; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } else { n = 1; for (t = 0; t < l; t++) { h = h << 1 | n; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = 0 } n = u.charCodeAt(0); for (t = 0; t < 16; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } a--; if (a == 0) { a = Math.pow(2, l); l++ } delete i[u] } else { n = r[u]; for (t = 0; t < l; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } } a--; if (a == 0) { a = Math.pow(2, l); l++ } } n = 2; for (t = 0; t < l; t++) { h = h << 1 | n & 1; if (p == 15) { p = 0; c += v(h); h = 0 } else { p++ } n = n >> 1 } while (true) { h = h << 1; if (p == 15) { c += v(h); break } else p++ } return c }, decompress: function (e) { if (e == null) return ""; if (e == "") return null; var t = [], n, r = 4, i = 4, s = 3, o = "", u = "", a, f, l, c, h, p, d, v = LZString._f, m = { string: e, val: e.charCodeAt(0), position: 32768, index: 1 }; for (a = 0; a < 3; a += 1) { t[a] = a } l = 0; h = Math.pow(2, 2); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } switch (n = l) { case 0: l = 0; h = Math.pow(2, 8); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } d = v(l); break; case 1: l = 0; h = Math.pow(2, 16); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } d = v(l); break; case 2: return "" }t[3] = d; f = u = d; while (true) { if (m.index > m.string.length) { return "" } l = 0; h = Math.pow(2, s); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } switch (d = l) { case 0: l = 0; h = Math.pow(2, 8); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } t[i++] = v(l); d = i - 1; r--; break; case 1: l = 0; h = Math.pow(2, 16); p = 1; while (p != h) { c = m.val & m.position; m.position >>= 1; if (m.position == 0) { m.position = 32768; m.val = m.string.charCodeAt(m.index++) } l |= (c > 0 ? 1 : 0) * p; p <<= 1 } t[i++] = v(l); d = i - 1; r--; break; case 2: return u }if (r == 0) { r = Math.pow(2, s); s++ } if (t[d]) { o = t[d] } else { if (d === i) { o = f + f.charAt(0) } else { return null } } u += o; t[i++] = f + o.charAt(0); r--; f = o; if (r == 0) { r = Math.pow(2, s); s++ } } } }; if (typeof module !== "undefined" && module != null) { module.exports = LZString }
	</script>
</head>

<body>
	<header>
		<div class="logo-wrapper">
			<h1>Parsing Editor</h1>
		</div>
		<div class="nav-wrapper">

			<a class="validateWithSamwill">Parse logs</a>
			<a class="reset_btn0" href="">Reset</a>
		</div>
	</header>
	<div class="errorStatus" style="display: none;">
		<p></p>
	</div>
	<div class="main-wrapper">
		<div class="container">
			<div class="row">

				<div class='span8 col-md-8 columns eight large-8'>
					<div class="editor-top-section">
						<h2>Pipeline</h2>
						<div id="setvalue" class="switcher-json">
							<svg width="20" height="13" viewBox="0 0 20 13" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M19.8729 5.98463C19.6942 5.74021 15.4371 0 9.99991 0C4.56275 0 0.305392 5.74021 0.126914 5.98439C-0.0423048 6.21627 -0.0423048 6.53076 0.126914 6.76264C0.305392 7.00705 4.56275 12.7473 9.99991 12.7473C15.4371 12.7473 19.6942 7.00701 19.8729 6.76283C20.0424 6.531 20.0424 6.21627 19.8729 5.98463ZM9.99991 11.4286C5.99486 11.4286 2.52606 7.61869 1.49922 6.37318C2.52473 5.12658 5.98627 1.31868 9.99991 1.31868C14.0048 1.31868 17.4733 5.1279 18.5006 6.37408C17.4751 7.62065 14.0136 11.4286 9.99991 11.4286Z"
									fill="black" />
								<path
									d="M10 2.41759C7.81868 2.41759 6.04395 4.19232 6.04395 6.37365C6.04395 8.55499 7.81868 10.3297 10 10.3297C12.1813 10.3297 13.9561 8.55499 13.9561 6.37365C13.9561 4.19232 12.1813 2.41759 10 2.41759ZM10 9.011C8.54571 9.011 7.36266 7.82792 7.36266 6.37365C7.36266 4.91939 8.54575 3.7363 10 3.7363C11.4543 3.7363 12.6374 4.91939 12.6374 6.37365C12.6374 7.82792 11.4543 9.011 10 9.011Z"
									fill="black" />
							</svg> <span>JSON</span>
						</div>
					</div>
					<div class="builder-format">
						<div id='editor'></div>
					</div>

					<div class="json-format" style="display:none">
						<div style="display: none;">
							<h2>JSON Output</h2>
							<p>You can also make changes to the JSON here and set the value in the editor by clicking <button
									class='btn btn-primary' id='setvalue'>Update Form</button></p>

						</div>
						<textarea id='output' style='width: 100%; height: 300px; font-family: monospace;'
							class='form-control'></textarea>

						<div id="editorOutput"></div>

						<div style="display: none;">
							<h2>Validation</h2>
							<p>This will update whenever the form changes to show validation errors if there are any.</p>
							<textarea id='validate' style='width: 100%; height: 100px; font-family: monospace;' readonly disabled
								class='form-control'></textarea>
						</div>
					</div>
				</div>

				<div class='span4 col-md-4 columns four large-4'>
					<!-- <div>
						<a href='#' id='direct_link'>Direct Link</a> (preserves schema, value, and options)
					</div> -->

					<div class="tab-nav-contaier">
						<div class="tab-nav-controller">
							<div class="tab-nav-item active" data-tabitem="sample">
								<p>Sample</p>
							</div>
							<div class="tab-nav-item" data-tabitem="parsedlogs">
								<p>Parsed Log</p>
							</div>
						</div>
						<div class="tab-nav-body">
							<div class="tab-nav-body__item active" data-tabbody="sample">
								<div class="innerTab">
									<ul>
										<li data-togglerInput="uploadView">Input</li>
										<li data-togglerInput="uploadView" class="active">Upload</li>
									</ul>
								</div>
								<input id="fileUploadButton" hidden="hidden" type="file">
								<label for="fileUploadButton" class="inputView uploadView active">
									<div class="iconText">
										<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
											<path d="M6 2L6 7" stroke="#A6ABC4" stroke-width="2" stroke-linecap="round" />
											<path d="M3.5 3.5L5.29289 1.70711C5.68342 1.31658 6.31658 1.31658 6.70711 1.70711L8.5 3.5"
												stroke="#A6ABC4" stroke-width="2" stroke-linecap="round" />
											<path d="M11 6C11 8.76142 8.76142 11 6 11C3.23858 11 1 8.76142 1 6" stroke="#A6ABC4"
												stroke-width="2" stroke-linecap="round" />
										</svg>

										upload Sample
									</div>
								</label>
								<textarea class="inputView sampleBox" name="samplesBox" id="samplesBox" rows="10"
									spellcheck="false"></textarea>

							</div>
							<div class="tab-nav-body__item" data-tabbody="parsedlogs">
								<textarea class="sampleBox" name="parsedLogs" id="parsedLogs" rows="10" spellcheck="false"></textarea>

							</div>

						</div>
					</div>



				</div>

			</div>
		</div>
	</div>
	<script src='scripts/errorHandler.js'></script>
	<script src='scripts/addon.js'></script>
	<script src="./src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
	<script src="./src-min-noconflict/ext-language_tools.js"></script>
	<script>
		// trigger extension
		ace.require("ace/ext/language_tools");
		let editor = ace.edit("editorOutput");
		editor.session.setMode("ace/mode/json");
		editor.setTheme("ace/theme/idle_fingers");
		// enable autocompletion and snippets
		editor.setOptions({
			enableBasicAutocompletion: false,
			enableSnippets: true,
			enableLiveAutocompletion: true
		});
		(function () {

			var schema;
			if (window.location.href.match('[?&]schema=([^&]+)')) {
				try {
					schema = JSON.parse(LZString.decompressFromBase64(window.location.href.match('[?&]schema=([^&]+)')[1]));
				}
				catch (e) {
					console.log('invalid starting schema');
				}
			}

			// Default starting schema
			if (!schema) {
				schema = {
					"definitions": {
						"Step": {
							"type": "object",
							"oneOf": [
								{
									"title": "convert",
									"required": [
										"convert"
									],
									"properties": {
										"convert": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"path",
														"paths",
														"type"
													],
													"properties": {
														"path": {
															"type": "string"
														},
														"paths": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"type": {
															"type": "string",
															"enum": [
																"int",
																"long",
																"float",
																"double",
																"string",
																"boolean"
															]
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "userAgent",
									"required": [
										"userAgent"
									],
									"properties": {
										"userAgent": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"prefix": {
															"type": "string"
														},
														"truncatedInputLength": {
															"type": "number"
														},
														"tagOnTruncated": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "json",
									"required": [
										"json"
									],
									"properties": {
										"json": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "docSize",
									"required": [
										"docSize"
									],
									"properties": {
										"docSize": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"targetField": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "addTag",
									"required": [
										"addTag"
									],
									"properties": {
										"addTag": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"tags"
													],
													"properties": {
														"tags": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "ahoCorasick",
									"required": [
										"ahoCorasick"
									],
									"properties": {
										"ahoCorasick": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field",
														"inputWords"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"inputWords": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "geoIp",
									"required": [
										"geoIp"
									],
									"properties": {
										"geoIp": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"sourceField"
													],
													"properties": {
														"sourceField": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"properties": {
															"type": "array",
															"items": {
																"type": "string",
																"enum": [
																	"ip",
																	"country_name",
																	"country_code2",
																	"continent_code",
																	"region_name",
																	"real_region_name",
																	"city_name",
																	"latitude",
																	"longitude",
																	"timezone",
																	"postal_code",
																	"location",
																	"dma_code"
																]
															}
														},
														"tagsOnSuccess": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "upperCase",
									"required": [
										"upperCase"
									],
									"properties": {
										"upperCase": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"fields"
													],
													"properties": {
														"fields": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "grok",
									"required": [
										"grok"
									],
									"properties": {
										"grok": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field",
														"patterns"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"patterns": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"overwrite": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"ignoreMissing": {
															"type": "boolean"
														},
														"tagsOnFailure": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "translate",
									"required": [
										"translate"
									],
									"properties": {
										"translate": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field",
														"dictionary"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"dictionary": {
															"type": "object",
															"patternProperties": {
																".*": {
																	"type": "string"
																}
															}
														},
														"fallback": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "substring",
									"required": [
										"substring"
									],
									"properties": {
										"substring": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"begin": {
															"type": "number"
														},
														"end": {
															"type": "number"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "drop",
									"required": [
										"drop"
									],
									"properties": {
										"drop": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"percentage": {
															"type": "number"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "split",
									"required": [
										"split"
									],
									"properties": {
										"split": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field",
														"separator"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"separator": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "rename",
									"required": [
										"rename"
									],
									"properties": {
										"rename": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"from": {
															"type": "string"
														},
														"to": {
															"type": "string"
														},
														"renames": {
															"type": "object",
															"patternProperties": {
																".*": {
																	"type": "string"
																}
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "urlDecode",
									"required": [
										"urlDecode"
									],
									"properties": {
										"urlDecode": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"allFields": {
															"type": "boolean"
														},
														"charset": {
															"type": "string"
														},
														"field": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "strip",
									"required": [
										"strip"
									],
									"properties": {
										"strip": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"fields"
													],
													"properties": {
														"fields": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "removeTag",
									"required": [
										"removeTag"
									],
									"properties": {
										"removeTag": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"tags"
													],
													"properties": {
														"tags": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "anonymize",
									"required": [
										"anonymize"
									],
									"properties": {
										"anonymize": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"fields",
														"key"
													],
													"properties": {
														"fields": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"algorithm": {
															"type": "string",
															"enum": [
																"SHA1",
																"SHA256",
																"SHA384",
																"SHA512",
																"MD5"
															]
														},
														"key": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "gsub",
									"required": [
										"gsub"
									],
									"properties": {
										"gsub": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field",
														"pattern",
														"replacement"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"pattern": {
															"type": "string"
														},
														"replacement": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "removeField",
									"required": [
										"removeField"
									],
									"properties": {
										"removeField": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"path": {
															"type": "string"
														},
														"fields": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "xml",
									"required": [
										"xml"
									],
									"properties": {
										"xml": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"xpath": {
															"type": "object",
															"patternProperties": {
																".*": {
																	"type": "string"
																}
															}
														},
														"storeXml": {
															"type": "boolean"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "lowerCase",
									"required": [
										"lowerCase"
									],
									"properties": {
										"lowerCase": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "deDot",
									"required": [
										"deDot"
									],
									"properties": {
										"deDot": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"separator": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "csv",
									"required": [
										"csv"
									],
									"properties": {
										"csv": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"separator": {
															"type": "string"
														},
														"quoteChar": {
															"type": "string"
														},
														"columns": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"autoGenerateColumnNames": {
															"type": "boolean"
														},
														"skipEmptyColumns": {
															"type": "boolean"
														},
														"convert": {
															"type": "object",
															"patternProperties": {
																".*": {
																	"type": "string"
																}
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "math",
									"required": [
										"math"
									],
									"properties": {
										"math": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"targetField",
														"expression"
													],
													"properties": {
														"targetField": {
															"type": "string"
														},
														"expression": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "kv",
									"required": [
										"kv"
									],
									"properties": {
										"kv": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"includeKeys": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"excludeKeys": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"fieldSplit": {
															"type": "string"
														},
														"valueSplit": {
															"type": "string"
														},
														"allowDuplicateValues": {
															"type": "boolean"
														},
														"includeBrackets": {
															"type": "boolean"
														},
														"prefix": {
															"type": "string"
														},
														"recursive": {
															"type": "boolean"
														},
														"trim": {
															"type": "string"
														},
														"trimKey": {
															"type": "string"
														},
														"maxKeyLength": {
															"type": "number"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "date",
									"required": [
										"date"
									],
									"properties": {
										"date": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"field"
													],
													"properties": {
														"field": {
															"type": "string"
														},
														"targetField": {
															"type": "string"
														},
														"formats": {
															"type": "array",
															"items": {
																"type": "string"
															}
														},
														"timeZone": {
															"type": "string"
														},
														"outputFormat": {
															"type": "string"
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "appendList",
									"required": [
										"appendList"
									],
									"properties": {
										"appendList": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"path",
														"values"
													],
													"properties": {
														"path": {
															"type": "string"
														},
														"values": {
															"type": "array",
															"items": {
																"type": "string"
															}
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"title": "addField",
									"required": [
										"addField"
									],
									"properties": {
										"addField": {
											"type": "object",
											"required": [
												"config"
											],
											"title": " ",
											"properties": {
												"config": {
													"title": " ",
													"type": "object",
													"required": [
														"path",
														"value"
													],
													"properties": {
														"path": {
															"type": "string"
														},
														"value": {
															"type": [
																"string",
																"boolean",
																"number",
																"boolean"
															]
														}
													}
												},
												"onFailure": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"onSuccess": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "if",
									"required": [
										"if"
									],
									"properties": {
										"if": {
											"type": "object",
											"required": [
												"condition",
												"then"
											],
											"title": " ",
											"properties": {
												"condition": {
													"type": "object",
													"$ref": "#/definitions/Condition"
												},
												"then": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												},
												"else": {
													"type": "array",
													"items": {
														"$ref": "#/definitions/Step"
													}
												}
											}
										}
									}
								}
							]
						},
						"Condition": {
							"type": "object",
							"oneOf": [
								{
									"additionalProperties": false,
									"title": "not",
									"required": [
										"not"
									],
									"properties": {
										"not": {
											"title": " ",
											"type": "array",
											"items": {
												"$ref": "#/definitions/Condition"
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "mathComparator",
									"required": [
										"mathComparator"
									],
									"properties": {
										"mathComparator": {
											"title": " ",
											"type": "object",
											"required": [
												"field",
												"gte",
												"gt",
												"lte",
												"lt"
											],
											"properties": {
												"field": {
													"type": "string"
												},
												"gte": {
													"type": "number"
												},
												"gt": {
													"type": "number"
												},
												"lte": {
													"type": "number"
												},
												"lt": {
													"type": "number"
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "exists",
									"required": [
										"exists"
									],
									"properties": {
										"exists": {
											"title": " ",
											"type": "object",
											"required": [
												"field"
											],
											"properties": {
												"field": {
													"type": "string"
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "and",
									"required": [
										"and"
									],
									"properties": {
										"and": {
											"title": " ",
											"type": "array",
											"items": {
												"$ref": "#/definitions/Condition"
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "in",
									"required": [
										"in"
									],
									"properties": {
										"in": {
											"title": " ",
											"type": "object",
											"required": [
												"path",
												"value"
											],
											"properties": {
												"path": {
													"type": "string"
												},
												"value": {
													"type": "string"
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "hasValue",
									"required": [
										"hasValue"
									],
									"properties": {
										"hasValue": {
											"title": " ",
											"type": "object",
											"required": [
												"field",
												"possibleValues"
											],
											"properties": {
												"field": {
													"type": "string"
												},
												"possibleValues": {
													"type": "array",
													"items": {
														"type": [
															"string",
															"boolean",
															"number",
															"boolean"
														]
													}
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "fieldType",
									"required": [
										"fieldType"
									],
									"properties": {
										"fieldType": {
											"title": " ",
											"type": "object",
											"required": [
												"path",
												"type"
											],
											"properties": {
												"path": {
													"type": "string"
												},
												"type": {
													"type": "string"
												}
											}
										}
									}
								},
								{
									"additionalProperties": false,
									"title": "or",
									"required": [
										"or"
									],
									"properties": {
										"or": {
											"title": " ",
											"type": "array",
											"items": {
												"$ref": "#/definitions/Condition"
											}
										}
									}
								}
							]
						}
					},
					"type": "object",
					"required": [
						"steps"
					],
					"properties": {
						"steps": {
							"type": "array",
							"items": {
								"$ref": "#/definitions/Step"
							}
						},
						"stopOnFailure": {
							"type": "boolean"
						}
					}
				}
			}

			// Divs/textareas on the page
			// var $schema = document.getElementById('schema');
			var $output = document.getElementById('output');
			var $editor = document.getElementById('editor');
			var $validate = document.getElementById('validate');

			// Buttons
			var $set_schema_button = document.getElementById('setschema');
			var $set_value_button = document.getElementById('setvalue');

			var jsoneditor;

			var updateDirectLink = function () {
				var url = window.location.href.replace(/\?.*/, '');

				url += '?schema=' + LZString.compressToBase64(JSON.stringify(schema));
				url += '&value=' + LZString.compressToBase64(JSON.stringify(jsoneditor.getValue()));

				for (var i in JSONEditor.defaults.options) {
					if (!JSONEditor.defaults.options.hasOwnProperty(i)) continue;
					if (JSONEditor.defaults.options[i] === false) continue;
					else if (JSONEditor.defaults.options[i] === true) {
						url += '&' + i;
					}
					else {
						url += '&' + i + '=' + JSONEditor.defaults.options[i];
					}
				}

				// document.getElementById('direct_link').href = url;
			};

			var reload = function (keep_value) {
				var startval = (jsoneditor && keep_value) ? jsoneditor.getValue() : window.startval;
				window.startval = undefined;
				console.log(keep_value);
				startval = {
					"steps": [],
				}
				if (jsoneditor) jsoneditor.destroy();
				jsoneditor = new JSONEditor($editor, {
					schema: schema,
					startval: startval
				});
				window.jsoneditor = jsoneditor;

				// When the value of the editor changes, update the JSON output and validation message
				jsoneditor.on('change', function () {
					var json = jsoneditor.getValue();

					$output.value = JSON.stringify(json, null, 2);

					var validation_errors = jsoneditor.validate();
					// Show validation errors if there are any
					if (validation_errors.length) {
						$validate.value = JSON.stringify(validation_errors, null, 2);
					}
					else {
						$validate.value = 'valid';
					}

					updateDirectLink();
				});
			};

			// Start the schema and output textareas with initial values
			// $schema.value = JSON.stringify(schema, null, 2);
			$output.value = '';

			// When the 'update form' button is clicked, set the editor's value
			$set_value_button.addEventListener('click', function () {
				jsoneditor.setValue(JSON.parse($output.value));
			});

			// Update the schema when the button is clicked
			// $set_schema_button.addEventListener('click', function () {
			// 	try {
			// 		// schema = JSON.parse($schema.value);
			// 	}
			// 	catch (e) {
			// 		alert('Invalid Schema: ' + e.message);
			// 		return;
			// 	}

			// 	reload();
			// });

			// Set the theme by loading the right stylesheets
			var setTheme = function (theme, no_reload) {
				theme = theme || '';

				var mapping = {
					barebones: '',
					html: '',
					bootstrap2: '//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css',
					bootstrap3: '//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css',
					foundation3: '//cdnjs.cloudflare.com/ajax/libs/foundation/3.2.5/stylesheets/foundation.css',
					foundation4: '//cdn.jsdelivr.net/foundation/4.3.2/css/foundation.min.css',
					foundation5: '//cdn.jsdelivr.net/foundation/5.0.2/css/foundation.min.css',
					foundation6: '//cdn.jsdelivr.net/foundation/6.2.1/foundation.min.css',
					jqueryui: '//code.jquery.com/ui/1.10.3/themes/south-street/jquery-ui.css'
				};

				if (typeof mapping[theme] === 'undefined') {
					theme = 'bootstrap3';
					document.getElementById('theme_switcher').value = theme;
				}

				JSONEditor.defaults.options.theme = theme;

				document.getElementById('theme_stylesheet').href = mapping[theme];
				//	document.getElementById('theme_switcher').value = JSONEditor.defaults.options.theme;

				if (!no_reload) reload(true);
			};

			// Set the icontheme
			// Set the theme by loading the right stylesheets
			var setIconlib = function (iconlib, no_reload) {
				iconlib = iconlib || '';
				var mapping = {
					foundation2: '//cdnjs.cloudflare.com/ajax/libs/foundicons/2.0/stylesheets/general_foundicons.css',
					foundation3: '//cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css',
					fontawesome3: '//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.css',
					fontawesome4: '//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css'
				};

				JSONEditor.defaults.options.iconlib = iconlib;

				document.getElementById('icon_stylesheet').href = mapping[iconlib] || '';

				// document.getElementById('icon_switcher').value = JSONEditor.defaults.options.iconlib;

				if (!no_reload) reload(true);
			};
			// JSONEditor.defaults.options.display_required_only = ;

			// JSONEditor.defaults.options.max_depth = 0;
			JSONEditor.defaults.options.array_controls_top = true;
			JSONEditor.defaults.options.disable_edit_json = true;
			JSONEditor.defaults.options.disable_array_reorder = true;
			JSONEditor.defaults.options.disable_collapse = true;
			JSONEditor.defaults.options.disable_properties = true;
			JSONEditor.defaults.options.no_additional_properties = true;
			JSONEditor.defaults.options.show_opt_in = true;
			JSONEditor.defaults.options.disable_array_delete_last_row = true;

			// show_opt_in

			// var refreshBooleanOptions = function (no_reload) {
			// 	var boolean_options = document.getElementById('boolean_options').children;
			// 	for (var i = 0; i < boolean_options.length; i++) {
			// 		JSONEditor.defaults.options[boolean_options[i].value] = boolean_options[i].selected;
			// 	}
			// 	if (!no_reload) reload(true);
			// };

			// Change listeners for options
			// document.getElementById('theme_switcher').addEventListener('change', function () {
			// 	setTheme(this.value);
			// });
			// document.getElementById('icon_switcher').addEventListener('change', function () {
			// 	setIconlib(this.value);
			// });
			// document.getElementById('object_layout').addEventListener('change', function () {
			// 	JSONEditor.defaults.options.object_layout = this.value;
			// 	reload(true);
			// });
			// document.getElementById('show_errors').addEventListener('change', function () {
			// 	JSONEditor.defaults.options.show_errors = this.value;
			// 	reload(true);
			// });
			// document.getElementById('boolean_options').addEventListener('change', function () {
			// 	refreshBooleanOptions();
			// });

			// Get starting value from url
			if (window.location.href.match('[?&]value=([^&]+)')) {
				window.startval = JSON.parse(LZString.decompressFromBase64(window.location.href.match('[?&]value=([^&]+)')[1]));
			}

			// Set options from direct link
			setTheme((window.location.href.match(/[?&]theme=([^&]+)/) || [])[1] || 'bootstrap3', true);

			setIconlib((window.location.href.match(/[?&]iconlib=([^&]*)/) || [null, 'fontawesome4'])[1], true);

			// document.getElementById('object_layout').value = (window.location.href.match(/[?&]object_layout=([^&]+)/) || [])[1] || 'normal';
			JSONEditor.defaults.options.object_layout = 'grid';

			// document.getElementById('show_errors').value = (window.location.href.match(/[?&]show_errors=([^&]+)/) || [])[1] || 'interaction';
			JSONEditor.defaults.options.show_errors = 'interaction'

			// var boolean_options = document.getElementById('boolean_options').children;
			// for (var i = 0; i < boolean_options.length; i++) {
			// 	if (window.location.href.match(new RegExp('[?&]' + boolean_options[i].getAttribute('value') + '([&=]|$)'))) {
			// 		boolean_options[i].selected = true;
			// 	}
			// }
			//	refreshBooleanOptions(true);

			reload();
		})();
	</script>
</body>

</html>